# Task 10: engineanalysistab.cpp 分割（ISSUE-022）

## フェーズ
C: 巨大ファイル上位の削減

## 前提条件
- Task 09（ISSUE-021）が完了していること

## 目的
`engineanalysistab.cpp`（1378行）のWidget肥大化を抑制し、UI構築・更新・イベント処理を分離する。

## 現状
- `src/widgets/engineanalysistab.cpp`: 1378行
- エンジン解析結果の表示タブ（UI構築 + データ更新 + ユーザー操作処理が混在）

## 対象ファイル
- `src/widgets/engineanalysistab.h` — 分割元ヘッダー
- `src/widgets/engineanalysistab.cpp` — 分割元実装
- 新規クラスファイル
- `CMakeLists.txt`

## 詳細手順

### Step 1: 責務の分析
`engineanalysistab.cpp` を全文読み、メソッドを以下に分類:

1. **UI構築** — ウィジェット生成・レイアウト設定・初期化
2. **データ更新** — エンジン出力の解析・表示データへの変換
3. **イベント処理** — ユーザー操作（クリック・選択・コンテキストメニュー）
4. **設定管理** — 列幅・表示設定の保存/復元

### Step 2: UI構築の分離（PR-022-a 相当）
- ウィジェット構築コード（レイアウト、ボタン配置等）を `EngineAnalysisTabBuilder` または `setupUi()` メソッドに集約
- Widget クラスは構築後の操作に集中

### Step 3: 更新ロジックの分離（PR-022-b 相当）
- エンジン出力の解析・表示更新を `EngineAnalysisPresenter` として抽出
- データ変換ロジックをUIフレームワーク依存から可能な限り分離

### Step 4: 段階的実装
1. 各カテゴリのメソッド一覧を確定
2. 依存関係の少ないカテゴリから抽出開始
3. テスト実行で回帰なしを確認

### Step 5: CMakeLists.txt の更新

### Step 6: ビルド・テスト
```bash
cmake --build build
cd build && ctest --output-on-failure
```

## 完了条件
- [ ] 解析タブの挙動が互換（全テスト Pass）
- [ ] `engineanalysistab.cpp` の行数が削減（目標: 800行以下）
- [ ] UI構築と更新ロジックが分離されている
- [ ] 構造KPIテストが Pass

## 検証コマンド
```bash
cmake --build build
cd build && ctest --output-on-failure
wc -l src/widgets/engineanalysistab.cpp
cd build && ctest --output-on-failure -R tst_structural_kpi
```
