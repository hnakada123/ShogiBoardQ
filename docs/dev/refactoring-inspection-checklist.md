# C++ リファクタリング検査項目（ShogiBoardQ）

以下は、このプロジェクトで C++ ソースをリファクタリングする際の確認用チェックリスト。

- [ ] 目的と非目的（何を改善し、何は変えないか）を PR/作業メモに明記した
- [ ] 既存仕様（USI/CSA/KIF/KI2/JKF など）に影響する可能性を事前に洗い出した
- [ ] `MainWindow` の責務を増やしていない（可能なら coordinator/controller/service 側へ移譲した）
- [ ] 1 クラス 1 責務を維持し、巨大メソッド・巨大ファイル化を抑制した
- [ ] `friend` 追加を避け、公開 API または適切な抽象で依存を解決した
- [ ] 所有権を明確化し、生ポインタの新規導入を避けた（Qt 親子関係 or スマートポインタを使用）
- [ ] `QObject` のライフタイムが安全で、破棄順依存・ダングリング接続を作っていない
- [ ] `connect()` は Qt のメンバー関数ポインタ構文を使い、不要な lambda 接続を増やしていない
- [ ] `const` 妥当性を保ち、不要なミュータブル状態や副作用を増やしていない
- [ ] ヘッダー依存を見直し、不要 `#include` を減らし前方宣言を適用した
- [ ] 命名が既存規約（ファイル: lower_snake、クラス: CamelCase）と一貫している
- [ ] マジックナンバー・重複ロジックを定数化/共通化し、意図が読める構造にした
- [ ] 例外・エラー時の挙動（失敗時の復元、ユーザー通知、ログ）を退行させていない
- [ ] UI 文字列を変更した場合、`tr()` の使用漏れがない
- [ ] ダイアログ/表示設定を追加・変更した場合、`SettingsService` の永続化項目を更新した
- [ ] 公開シグネチャ変更時に呼び出し側・テスト・ドキュメントの整合を取った
- [ ] 新規/更新テストを `tests/` に追加し、既存テストの期待値破壊を確認した
- [ ] `cmake --build build` を実行し、警告ゼロ（`-Wall -Wextra -Wpedantic -Wshadow -Wconversion`）を維持した
- [ ] `ctest --test-dir build --output-on-failure` を実行し、失敗がないことを確認した
- [ ] 変更内容に応じて関連ドキュメント（`docs/dev`、必要なら翻訳 `.ts`）を更新した
