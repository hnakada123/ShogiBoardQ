# ベースライン計測（2026-02-28）

## 概要指標

| 指標 | 値 |
|---|---:|
| src/ 内 .cpp/.h ファイル数 | 518 |
| src/ 総行数 | 103,800 |
| 600行超ファイル数 | 32 |
| 800行超ファイル数 | 13 |
| 1000行超ファイル数 | 3 |
| テスト数 | 41 |
| テスト結果 | 41/41 Pass |
| delete 文（コード行のみ） | 5 |
| lambda connect | 0 |
| 旧式 SIGNAL/SLOT | 0 |
| MainWindow public slots | 13 |

## 600行超ファイル一覧

```
1133 src/analysis/analysisflowcontroller.cpp
1084 src/engine/usi.cpp
1018 src/widgets/evaluationchartwidget.cpp
 933 src/kifu/kifuexportcontroller.cpp
 930 src/core/fmvlegalcore.cpp
 902 src/engine/usiprotocolhandler.cpp
 884 src/dialogs/pvboarddialog.cpp
 842 src/dialogs/engineregistrationdialog.cpp
 838 src/dialogs/josekimovedialog.cpp
 820 src/core/shogiboard.cpp
 808 src/views/shogiview_draw.cpp
 804 src/dialogs/changeenginesettingsdialog.cpp
 802 src/views/shogiview.cpp
 798 src/network/csagamecoordinator.cpp
 789 src/game/matchcoordinator.cpp
 758 src/kifu/formats/csaexporter.cpp
 735 src/kifu/formats/jkfexporter.cpp
 727 src/game/gamestartcoordinator.cpp
 720 src/ui/coordinators/kifudisplaycoordinator.cpp
 704 src/views/shogiview_labels.cpp
 693 src/network/csaclient.cpp
 689 src/engine/shogiengineinfoparser.cpp
 677 src/widgets/recordpane.cpp
 657 src/dialogs/tsumeshogigeneratordialog.cpp
 652 src/game/shogigamecontroller.cpp
 642 src/navigation/kifunavigationcontroller.cpp
 640 src/kifu/formats/parsecommon.cpp
 638 src/kifu/kifuapplyservice.cpp
 638 src/dialogs/startgamedialog.cpp
 634 src/widgets/considerationtabmanager.cpp
 632 src/widgets/branchtreemanager.cpp
 607 src/widgets/engineanalysistab.cpp
```

## 1000行超ファイル（分割優先対象）

1. `analysisflowcontroller.cpp` — 1,133行
2. `usi.cpp` — 1,084行
3. `evaluationchartwidget.cpp` — 1,018行

## delete 文の所在

| ファイル | 件数 |
|---|---:|
| src/engine/engineprocessmanager.cpp | 2 |
| src/dialogs/engineregistrationdialog.cpp | 1 |
| src/ui/wiring/matchcoordinatorwiring.cpp | 1 |
| src/widgets/flowlayout.cpp | 1 |
| **合計** | **5** |

## 構造KPIテスト結果

```
PASS: fileLineLimits
PASS: mainWindowFriendClassLimit
PASS: mainWindowEnsureLimit
PASS: largeFileCount (3 files over 1000 lines, limit: 4)
PASS: deleteCount (5, limit: 7)
PASS: lambdaConnectCount (0, limit: 1)
PASS: oldStyleConnectionCount (0, limit: 0)
PASS: mainWindowPublicSlotsLimit (13, limit: 50)
結果: 10 passed, 0 failed
```

## 計測コマンド

```bash
# ファイル数
find src -type f \( -name '*.cpp' -o -name '*.h' \) | wc -l

# 総行数
find src -type f \( -name '*.cpp' -o -name '*.h' \) -print0 | xargs -0 wc -l | tail -n 1

# 600行超ファイル一覧（合計行を除外）
find src -type f \( -name '*.cpp' -o -name '*.h' \) -print0 | xargs -0 wc -l | grep -v '合計' | awk '$1>600' | sort -nr

# 構造KPIテスト
QT_QPA_PLATFORM=offscreen build/tests/tst_structural_kpi
```

## 備考

- `future-improvement-analysis-2026-02-28.md` の600行超=33、800行超=14は `wc -l` の「合計」行を含んでいた。正確な値は上記の通り（32件、13件）。
- delete 文のカウントは `tst_structural_kpi` 準拠（コメント行・#include行を除外）。
